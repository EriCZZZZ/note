# 调度

## 什么是调度

## 进程行为

I/O密集型和计算密集型

## 何时调度

- 新进程创建之后，运行父进程还是子进程
- 一个进程退出
- 一个进程阻塞时
- 一个i/o中断发生时

### 抢占式调度和非抢占式调度

（硬件提供时钟中断）如何处理时钟中断分为两类。

## 调度算法的分类

- 批处理 非抢占式或长时钟周期的抢占式
- 交互式 抢占式 *e.g. 服务器*
- 实时 非抢占式

## 调度算法的目标

- common
  - 公平——让相同的进程拥有相同的CPU份额
  - 策略强制执行——可以按照策略违反公平原则
  - 平衡——保证系统的所有部分尽可能忙碌
- 批处理
  - 吞吐量——每小时最大作业数
  - 周转时间
  - CPU利用率
- 交互式
  - 响应时间
  - 均衡性
- 实时系统
  - 满足截止时间
  - 可预测性

## 批处理系统中的调度

### 先来先服务

### 最短作业优先

要明确知道每个作业需要的时间

只有在所有任务同时可以开始的时候，最短作业优先是最优解

### 最短剩余时间优先

最短作业优先的抢占版本

*每次新的作业到达时进行一次调度*

## 交互式系统中的调度

### 轮转调度 20-50ms

每个进程一个时间片，阻塞或超时就移动到队列尾部，等待下一个时间片

问题

- 时间片的长度和上下文切换时间的比例
- 时间片太短 短于平均cpu使用时间 会引发过多的上下文切换
- 时间片太长 新的命令的响应时间会过长

### 优先级调度

最高的优先级的 就绪 进程可以先运行

问题

- 防止高优先级无限运行

改进的一些trick

- 优先级可以是静态赋予或动态赋予
- 优先级可以由系统动态确定 有些进程为I/O密集型 就调高他的优先级

### 多级队列

CTSS

### 最短进程优先

需要根据以前的统计数据进行预测运行时间

### 保证调度

### 彩票调度

### 公平分享调度

## 实时系统中的调度

> 实时系统是一种时间起着主导作用的系统
>
> 外部设备发给计算机一个请求，必须在确定的时间范围内给出反应

### 可调度的

$$
\sum^m_{i=1} \frac{C_i}{P_i} \le 1
$$

其中，有i 个任务，每个任务C时间执行完毕，周期P

# 线程调度

与线程的实现方法密切相关